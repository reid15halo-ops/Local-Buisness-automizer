# =============================================================================
# FreyAI Visions – Hetzner VPS Environment Variables
# Zone 2 Infrastructure (CPX31)
# =============================================================================
# Copy this file to .env and fill in all values before running docker compose.
# NEVER commit .env to version control.
# =============================================================================

# -----------------------------------------------------------------------------
# DOMAIN & TLS
# -----------------------------------------------------------------------------

# The public domain pointing to this Hetzner VPS (A record required)
# Example: n8n.freyai.io
DOMAIN=YOUR_N8N_DOMAIN

# Email address for Let's Encrypt certificate registration and renewal notices
TRAEFIK_EMAIL=YOUR_LETSENCRYPT_EMAIL

# Traefik dashboard basic-auth users (generate with: htpasswd -nb admin password)
# Format: user:hashed_password  (colon-separated, escape $ as $$)
TRAEFIK_DASHBOARD_USERS=YOUR_HTPASSWD_USER_STRING

# -----------------------------------------------------------------------------
# n8n – Workflow Automation Engine
# -----------------------------------------------------------------------------

# Encryption key for n8n credentials store (min 32 chars, random string)
# Generate with: openssl rand -hex 32
N8N_ENCRYPTION_KEY=YOUR_N8N_ENCRYPTION_KEY_32_CHARS_MIN

# n8n web interface login credentials
N8N_BASIC_AUTH_USER=YOUR_N8N_ADMIN_USERNAME
N8N_BASIC_AUTH_PASSWORD=YOUR_N8N_ADMIN_PASSWORD_STRONG

# -----------------------------------------------------------------------------
# PostgreSQL – Internal n8n Database (NOT Supabase)
# Supabase is cloud-managed; this Postgres is only for n8n metadata/executions.
# -----------------------------------------------------------------------------

POSTGRES_DB=n8n
POSTGRES_USER=YOUR_POSTGRES_USERNAME
POSTGRES_PASSWORD=YOUR_POSTGRES_PASSWORD_STRONG

# -----------------------------------------------------------------------------
# Supabase – Cloud Database & Auth (FreyAI primary data store)
# Obtain from: https://supabase.com/dashboard → project → Settings → API
# -----------------------------------------------------------------------------

# Project URL (format: https://xxxxxxxxxxxx.supabase.co)
SUPABASE_URL=YOUR_SUPABASE_PROJECT_URL

# Service role key – NEVER expose to frontend; server-side only
SUPABASE_SERVICE_ROLE_KEY=YOUR_SUPABASE_SERVICE_ROLE_KEY

# Anon/public key (safe for frontend, included here for n8n HTTP nodes)
SUPABASE_ANON_KEY=YOUR_SUPABASE_ANON_KEY

# -----------------------------------------------------------------------------
# AI – OpenAI
# Obtain from: https://platform.openai.com/api-keys
# -----------------------------------------------------------------------------

OPENAI_API_KEY=YOUR_OPENAI_API_KEY

# Default model for n8n AI nodes (cost-controlled; override per workflow)
OPENAI_DEFAULT_MODEL=gpt-4o-mini

# -----------------------------------------------------------------------------
# GoCardless – Open Banking / Direct Debit
# Obtain from: https://manage.gocardless.com/developers
# -----------------------------------------------------------------------------

GOCARDLESS_CLIENT_ID=YOUR_GOCARDLESS_CLIENT_ID
GOCARDLESS_CLIENT_SECRET=YOUR_GOCARDLESS_CLIENT_SECRET

# GoCardless environment: sandbox | live
GOCARDLESS_ENVIRONMENT=sandbox

# -----------------------------------------------------------------------------
# Backend FastAPI Service
# Shared secret for authenticating n8n → backend API calls
# Generate with: openssl rand -hex 32
# -----------------------------------------------------------------------------

BACKEND_API_KEY=YOUR_BACKEND_API_KEY_32_CHARS_MIN

# Internal backend URL (used by n8n workflows to call the backend)
# Leave as default unless you change the service name in docker-compose.yml
BACKEND_INTERNAL_URL=http://backend:8001

# -----------------------------------------------------------------------------
# Networking – Tailscale VPN
# Obtain from: https://login.tailscale.com/admin/settings/keys
# Use a reusable, pre-authorised key for automated setup
# -----------------------------------------------------------------------------

TAILSCALE_AUTHKEY=YOUR_TAILSCALE_AUTH_KEY

# NAS hostname on Tailscale network (used by backup script)
# Example: nas-vault  (must match Tailscale machine name or MagicDNS entry)
NAS_TAILSCALE_HOSTNAME=nas-vault

# -----------------------------------------------------------------------------
# Backups – Restic + Tailscale SFTP to NAS
# -----------------------------------------------------------------------------

# Restic repository path on NAS (sftp protocol over Tailscale)
# Format: sftp:<tailscale-hostname>:<absolute-path>
RESTIC_REPOSITORY=sftp:nas-vault:/backups/hetzner

# Restic encryption password – keep this safe, you cannot recover backups without it
# Generate with: openssl rand -base64 48
RESTIC_PASSWORD=YOUR_RESTIC_BACKUP_ENCRYPTION_PASSWORD

# SSH user on NAS for SFTP (must have write access to the backup path)
NAS_SSH_USER=YOUR_NAS_SSH_USERNAME

# -----------------------------------------------------------------------------
# Watchtower – Auto-update notifications
# -----------------------------------------------------------------------------

WATCHTOWER_EMAIL_FROM=watchtower@freyai.local
WATCHTOWER_EMAIL_TO=YOUR_ALERT_EMAIL_ADDRESS

# SMTP settings for Watchtower update emails
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=YOUR_SMTP_USERNAME
SMTP_PASSWORD=YOUR_SMTP_APP_PASSWORD

# -----------------------------------------------------------------------------
# Optional – Rate limiting & misc
# -----------------------------------------------------------------------------

# Max requests per minute from a single IP (Traefik rate-limit middleware)
RATE_LIMIT_AVERAGE=100
RATE_LIMIT_BURST=50

# Log level for backend service: DEBUG | INFO | WARNING | ERROR
LOG_LEVEL=INFO
